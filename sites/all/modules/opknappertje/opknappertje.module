<?php
function opknappertje_block_info() {
  $blocks['hero_block'] = array(
    'info' => t('Hero block'),
    'region' => 'header',
    'cache' => DRUPAL_NO_CACHE,
  );

  return $blocks;
}

function opknappertje_block_view($delta = '') {
  $block = array();

  switch ($delta) {
    case 'hero_block':
      $block['subject'] = '<none>';
      $block['content'] = _opknappertje_hero_block_content(arg(1));
    break;
  }
  return $block;
}

function _opknappertje_hero_block_content($nid) {
  // page nodes for this block content
  $markup ='';

  if ($nid > 0) {
    $node = node_load($nid);
    $user = user_load($node->uid);

    if ( $node->type === 'contribution' ) {
      $markup = '
      <h1>De inzending van<br /><span>' . $user->realname . '</span></h1>
      <p>Je kunt 1x per inzending stemmen.</p>
      <ul><li>' . flag_create_link('vote', $node->nid) . '</li></ul>
      ';
    } else {
      $markup = '
      <h1>Knap je keuken op!</h1>
      <p>Maak een foto van je keuken en maak kans op een renovatiechecque t.w.v. <strong>â‚¬ 750,-</strong></p>
      <ul><li><a href="/node/add/contribution" class="btn btn-default">Doe direct mee!</a></li>
      <li><a href="/contributions" class="btn btn-default">De deelnemers</a></li></ul>
      ';
    }
  }
  return $markup;
}

function opknappertje_preprocess_node(&$variables){

  if ($variables['type'] === 'contribution') {
    $variables['user'] = user_load($variables['uid']);

  }
}
?>
